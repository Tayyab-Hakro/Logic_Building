class ListNode {
  int val;
  ListNode next;
  ListNode(int val) {
      this.val = val;
  }
}

public class PalindromeLinkedList {

  public boolean isPalindrome(ListNode head) {
      if (head == null || head.next == null) {
          return true;
      }

      // Step 1: Find the middle of the linked list
      ListNode slow = head;
      ListNode fast = head;
      while (fast != null && fast.next != null) {
          slow = slow.next;
          fast = fast.next.next;
      }

      // Step 2: Reverse the second half of the list
      ListNode secondHalf = reverse(slow);

      // Step 3: Compare first half and reversed second half
      ListNode firstHalf = head;
      while (secondHalf != null) {
          if (firstHalf.val != secondHalf.val) {
              return false;
          }
          firstHalf = firstHalf.next;
          secondHalf = secondHalf.next;
      }

      return true;
  }

  private ListNode reverse(ListNode head) {
      ListNode prev = null;
      while (head != null) {
          ListNode nextNode = head.next;
          head.next = prev;
          prev = head;
          head = nextNode;
      }
      return prev;
  }
}
